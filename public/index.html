<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="images/favicon.ico">

    <title>PJ</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap-3.3.6-dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="jumbotron.css" rel="stylesheet">

    <!-- Firebase configuration -->
    <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCleCXI68tsiwMnY8-VKDKBaF3NscCc0aU",
        authDomain: "plateaujuicing.firebaseapp.com",
        databaseURL: "https://plateaujuicing.firebaseio.com",
        storageBucket: "plateaujuicing.appspot.com",
      };
      firebase.initializeApp(config);
    </script>
    
    <!-- FirebaseUI for Web Auth: Installation -->
    <script src="https://www.gstatic.com/firebasejs/ui/live/0.4/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/live/0.4/firebase-ui-auth.css" />
    <script>
            // FirebaseUI config.
      var uiConfig = {
        'signInSuccessUrl': 'http://localhost:5000/',
        'signInOptions': [
          // Leave the lines as is for the providers you want to offer your users.
          firebase.auth.GoogleAuthProvider.PROVIDER_ID,
          firebase.auth.FacebookAuthProvider.PROVIDER_ID,
          //firebase.auth.TwitterAuthProvider.PROVIDER_ID,
          //firebase.auth.GithubAuthProvider.PROVIDER_ID,
          firebase.auth.EmailAuthProvider.PROVIDER_ID
        ],
        // Terms of service url.
        'tosUrl': '<your-tos-url>',
      };

      // Initialize the FirebaseUI Widget using Firebase.
      var ui = new firebaseui.auth.AuthUI(firebase.auth());
      // The start method will wait until the DOM is loaded.
      ui.start('#firebaseui-auth-container', uiConfig);
    </script>

    <!-- FirebaseUI for Web Auth: Tracking Auth state -->
    <script type="text/javascript">
    initApp = function() {
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          // User is signed in.
          var displayName = user.displayName;
          var email = user.email;
          var emailVerified = user.emailVerified;
          var photoURL = user.photoURL;
          var uid = user.uid;
          var providerData = user.providerData;
          user.getToken().then(function(accessToken) {
            document.getElementById('sign-in-status').textContent = 'Signed in';
            document.getElementById('sign-in').textContent = 'Sign out';
            // Create a JSON with user account details
            var accountDetails = JSON.stringify({
              displayName: displayName,
              email: email,
              emailVerified: emailVerified,
              photoURL: photoURL,
              uid: uid,
              accessToken: accessToken,
              providerData: providerData
              }, null, '  ');
            // Push user account details to HTML content
            document.getElementById('account-details').textContent = accountDetails;
            // Push user account details to Firebase
            firebase.database().ref("users/").push({
              displayName: displayName,
              email: email,
              emailVerified: emailVerified,
              photoURL: photoURL,
              uid: uid,
              accessToken: accessToken,
              providerData: providerData
              });
          }) 
        }
        else {
          // User is signed out.
          document.getElementById('sign-in-status').textContent = 'Signed out';
          document.getElementById('sign-in').textContent = 'Sign in';
          document.getElementById('account-details').textContent = 'null';
        }
      }, function(error) {
        console.log(error);
      });
    };

    window.addEventListener('load', function() {
      initApp()
    });
  </script>

  </head>

  <body>
  <!-- Facebook SDK for Javascript -->
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '651800564970614',
        xfbml      : true,
        version    : 'v2.6'
      });
    };

    (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Plateau Juicing</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <form class="navbar-form navbar-right">
            <div class="form-group">
              <input type="text" placeholder="Email" class="form-control" id="email">
            </div>
            <div class="form-group">
              <input type="password" placeholder="Password" class="form-control" id="password">
            </div>
            <button type="submit" class="btn btn-success" id="signin_button">Sign in</button>
          </form>
        </div><!--/.navbar-collapse -->
      </div>
    </nav>

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
      <div class="container">
        <h1>Local, Organic Juices <br>Delivered to Your Door</h1>
        <p>Delivering amazing Juices of freshly pressed juices of veggetables and fruits.</p>
        <p><a class="btn btn-default" href="#" role="button">Learn more about us &raquo;</a></p>
      </div>
      <!-- Firebase UI Auth container -->
      <div id="firebaseui-auth-container"></div>

      <div id="sign-in-status"></div>
      <div id="sign-in"></div>
      <div id="account-details"></div>

    </div>

    <div class="container">
      <!-- Example row of columns -->
      <section>
      <div class="row">
        <div class="col-md-4">
          <h2>The <i>"Red Orange"</i></h2>
          <img class="juices_main_page" src="images/red_orange-original.JPG" alt="Red Orange Juice">
          <p>
            The <i>"Red Orange"</i> is a perfect mix of <i>Beet</i> and <i>Carrots</i> as main ingredients. It is sweetened by <i>Apple</i> and spiced by <i>Ginger</i>.
          </p>
          <p>
            Profile: Vitamin A, Vitamin C, ...
          </p>
          <p><a class="btn btn-primary btn-lg" href="#" role="button" id="red_orange_order_button">Order! &raquo;</a></p>
        </div>
        </section>

        <div class="col-md-4">
          <h2>Heading</h2>
          <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
          <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
       </div>
        <div class="col-md-4">
          <h2>Heading</h2>
          <p>Donec sed odio dui. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Vestibulum id ligula porta felis euismod semper. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
          <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
        </div>
      </div>

      <hr>

      <footer>
        <p>&copy; Plateau Juicing, Inc.</p>
      </footer>
    </div> <!-- /container -->


  <script>
    var email_input = document.getElementById("email");
    var signin_button = document.getElementById("signin_button");
    
    signin_button.addEventListener("click", function() {

      console.log(email_input.value); 

      firebase.database().ref("users/").push({
        email: email_input.value
      });

    });
  </script>

  <script>
    var order_red_orange = document.getElementById("red_orange_order_button");

    red_orange_order_button.addEventListener("click", function() {

      console.log("Red Orange ordered!");

      firebase.database().ref("orders/").push({
        user: "Dummy user 1",
        juice_id: "Red Orange",
        qty: 1,
        delivery_adress: "2350 Boulvd Saint-Laurent"
      });

    });

  </script>

  </body>
</html>
